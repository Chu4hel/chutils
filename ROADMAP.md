# Дорожная карта

Этот документ содержит план действий по улучшению проекта.

## 2. Оптимизация логирования (f-строки)

* **Проблема:** Использование f-строк в вызовах логгера приводит к немедленному вычислению сообщений, даже если они не
  будут выведены.
* **План:**
    * Найти все вхождения `logger.level(f"...")` в файлах `src/` и `examples/`.
    * Заменить их на `logger.level("...", arg1, arg2)` для "ленивого" форматирования.

## 8. Рефакторинг больших функций (`get_config`)

* **Проблема:** Функция `get_config` слишком большая и содержит логику для разных форматов.
* **План:**
    * Разделить `get_config` на более мелкие, специализированные функции: `_load_yaml(path)` и `_load_ini(path)`.
    * `get_config` будет выступать в роли оркестратора, вызывая нужную функцию в зависимости от расширения файла.

## 10. Улучшение `setup_logger` (default `log_level_str` и `Enum`)

* **Проблема:** Неочевидное значение по умолчанию для `log_level_str` (`''`) и отсутствие `Enum` для уровней.
* **План:**
    * Изменить значение по умолчанию `log_level_str` в `setup_logger` на `'INFO'`.
    * Ввести `Enum` для уровней логирования, чтобы обеспечить лучшую валидацию и автодополнение.

## 12. Поддержка `.env` файлов в `secret_manager`

* **Проблема:** `keyring` может быть неудобен в некоторых средах (например, Docker), `.env` — более универсальный
  стандарт.
* **План:**
    * Добавить поддержку `.env` файлов в `secret_manager.py`.
    * Реализовать логику, при которой `secret_manager` сначала пытается получить секрет из `keyring`, а при неудаче (или
      по конфигурации) ищет его в `.env` файле в корне проекта.

## 13. Разделение лог-файлов по именам логгеров

* **Проблема:** Все логгеры по умолчанию пишут в один и тот же файл, указанный в глобальной конфигурации.
* **План:**
    * Добавить опциональный параметр `log_file_name: Optional[str] = None` в функцию `setup_logger`.
    * Если этот параметр указан, логгер будет писать в указанный файл.
    * Если параметр не указан, будет использоваться `log_file_name` из глобальной конфигурации.

## 14. Расширенные опции ротации логов (по размеру и сжатие)

* **Проблема:** Текущая ротация логов осуществляется только по времени. Нет возможности ротировать по размеру файла и
  сжимать старые логи.
* **План:**
    * Добавить в `setup_logger` (или в конфигурацию `Logging`) опции для:
        * Выбора типа ротации: по времени (`TimedRotatingFileHandler`) или по размеру (`RotatingFileHandler`).
        * Указания максимального размера файла для ротации по размеру.
        * Опционального сжатия ротированных лог-файлов (например, с использованием `gzip` из стандартной библиотеки).
          Это не потребует новых внешних зависимомостей, но потребует дополнительной реализации.

## 18. Поддержка переопределения конфигурации локальным файлом

* **Проблема:** Отсутствует встроенная поддержка для переопределения параметров основного конфигурационного файла (
  `config.yml`/`config.ini`) локальным файлом (например, `config.local.yml`), который может быть добавлен в
  `.gitignore`.
* **План:**
    * Реализовать механизм, позволяющий `chutils.config` загружать несколько конфигурационных файлов.
    * Параметры из локального файла будут переопределять соответствующие параметры из основного файла.
    * Это позволит удобно управлять чувствительными или специфичными для разработчика настройками, не коммитя их в
      репозиторий.
* **Приоритет:** Низкий

## 19. Предотвращение конфликтов имен в Keyring

* **Проблема:** Существует риск того, что другое приложение может использовать то же `service_name` в `keyring`, что
  приведет к перезаписи или несанкционированному доступу к секретам.
* **Текущее решение:** Добавленная возможность указывать пользовательский `prefix` для `SecretManager` уже позволяет
  пользователям самостоятельно управлять уникальностью `service_name`.
* **План:**
    * Рассмотреть возможность использования более уникального префикса по умолчанию, **включающего путь к проекту или
      его хэш**, чтобы гарантировать уникальность `service_name` для каждого проекта.
    * Улучшить документацию, чтобы подчеркнуть важность выбора уникального `service_name` и использования `prefix`.
* **Приоритет:** Низкий